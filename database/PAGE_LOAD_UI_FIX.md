# üîß Page Load UI State Fix

## –î–∞—Ç–∞: 2025-10-01
## –°—Ç–∞—Ç—É—Å: ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û

---

## üìã –ü—Ä–æ–±–ª–µ–º—ã –∏–∑ –æ—Ç—á–µ—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**–°–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è**: "–¢–µ–ø–µ—Ä—å —É –º–µ–Ω—è –≤ —Ä–∞–∑–¥–µ–ª–µ AI –ø–æ–∏—Å–∫ –ø—Ä–æ–ø–∞–ª–∞ –∫–Ω–æ–ø–∫–∞ –Ω–∞—á–∞—Ç—å –ø–∞—Ä—Å–∏–Ω–≥, –∏ —É –º–µ–Ω—è —Å–µ–π—á–∞—Å –Ω–∞ 2 –≤–∫–ª–∞–¥–∫–∞—Ö (AI –ø–æ–∏—Å–∫ –∏ –ü–æ URL) –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –≤–∏—Å–∏—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å –±–∞—Ä –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã. –ò –ø–ª—é—Å –µ—â—ë –∫–Ω–æ–ø–∫–∞ –ø—Ä–æ–ø–∞–ª–∞"

**–°–∫—Ä–∏–Ω—à–æ—Ç**: `–°–Ω–∏–º–æ–∫ —ç–∫—Ä–∞–Ω–∞ 2025-10-01 –≤ 10.46.25.png`

### –°–∏–º–ø—Ç–æ–º—ã:
1. ‚ùå –ö–Ω–æ–ø–∫–∞ "–ù–∞—á–∞—Ç—å –ø–∞—Ä—Å–∏–Ω–≥" **–û–¢–°–£–¢–°–¢–í–£–ï–¢** –≤ AI Search —Ñ–æ—Ä–º–µ
2. ‚ùå –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä **–ø–æ—Å—Ç–æ—è–Ω–Ω–æ –≤–∏–¥–µ–Ω** –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
3. ‚ùå –≠—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –Ω–∞ –û–ë–ï–ò–• –≤–∫–ª–∞–¥–∫–∞—Ö (AI –ø–æ–∏—Å–∫ –∏ –ü–æ URL)
4. ‚ùå –î–∞–∂–µ –∫–æ–≥–¥–∞ –Ω–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –ø–∞—Ä—Å–∏–Ω–≥–∞

---

## üîç Root Cause Analysis

### –ü—Ä–æ–±–ª–µ–º–∞ 1: Generic selector –≤ `checkAndRestoreActiveTask()`

**–§–∞–π–ª**: `script.js:4569`

**–ö–æ–¥ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã**:
```javascript
async checkAndRestoreActiveTask() {
    // ...
    const activeTask = activeTasks[0];
    this.currentTaskId = activeTask.id;

    // ‚ùå GENERIC SELECTOR - –Ω–∞—Ö–æ–¥–∏—Ç —Ç–æ–ª—å–∫–æ –ü–ï–†–í–£–Æ –∫–Ω–æ–ø–∫—É!
    const submitBtn = document.querySelector('.submit-btn');
    const progressBar = document.getElementById('modernProgressBar');
    const progressDesc = document.getElementById('progressDescription');

    if (submitBtn) submitBtn.style.display = 'none';  // ‚ùå –°–∫—Ä—ã–≤–∞–µ—Ç –û–î–ù–£ –∫–Ω–æ–ø–∫—É!
    if (progressBar) progressBar.classList.add('active');  // ‚ùå –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä!
    // ...
}
```

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è**:
1. –ù–∞—Ö–æ–¥–∏—Ç `.submit-btn` ‚Üí —ç—Ç–æ AI Search –∫–Ω–æ–ø–∫–∞ (–ø–µ—Ä–≤–∞—è –≤ DOM)
2. –°–∫—Ä—ã–≤–∞–µ—Ç –¢–û–õ–¨–ö–û AI Search –∫–Ω–æ–ø–∫—É
3. URL Parsing –∫–Ω–æ–ø–∫–∞ –æ—Å—Ç–∞–µ—Ç—Å—è –≤–∏–¥–∏–º–æ–π
4. –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –∞–∫—Ç–∏–≤–Ω—ã–º

### –ü—Ä–æ–±–ª–µ–º–∞ 2: –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ "–∑–∞—Å—Ç—Ä—è–≤—à–∏—Ö" –∑–∞–¥–∞—á

**–§–∞–π–ª**: `script.js:4547-4594`

**–õ–æ–≥–∏–∫–∞**:
```javascript
// –ü–æ–ª—É—á–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏ –∏–∑ –ë–î
const activeTasks = await response.json();
if (!activeTasks || activeTasks.length === 0) return;

// –ë–µ—Ä–µ–º –ø–µ—Ä–≤—É—é –∑–∞–¥–∞—á—É
const activeTask = activeTasks[0];
this.currentTaskId = activeTask.id;

// –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º UI –¥–ª—è –õ–Æ–ë–û–ô –∞–∫—Ç–∏–≤–Ω–æ–π –∑–∞–¥–∞—á–∏
// –î–∞–∂–µ –µ—Å–ª–∏ –æ–Ω–∞ "–∑–∞—Å—Ç—Ä—è–ª–∞" –≤ —Å—Ç–∞—Ç—É—Å–µ 'running' —á–∞—Å—ã/–¥–Ω–∏ –Ω–∞–∑–∞–¥!
```

**–ü—Ä–æ–±–ª–µ–º–∞**: –ó–∞–¥–∞—á–∏ –∫–æ—Ç–æ—Ä—ã–µ –∑–∞–≤–µ—Ä—à–∏–ª–∏—Å—å —Å –æ—à–∏–±–∫–æ–π –∏–ª–∏ –±—ã–ª–∏ –ø—Ä–µ—Ä–≤–∞–Ω—ã –º–æ–≥—É—Ç –æ—Å—Ç–∞–≤–∞—Ç—å—Å—è –≤ —Å—Ç–∞—Ç—É—Å–µ `'running'` –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö. –ü—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã —ç—Ç–∏ "–∑–æ–º–±–∏" –∑–∞–¥–∞—á–∏ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è!

### –ü—Ä–æ–±–ª–µ–º–∞ 3: –ù–µ—Ç fallback –¥–ª—è —á–∏—Å—Ç–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è

–ï—Å–ª–∏ –µ—Å—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏ (–¥–∞–∂–µ —Å—Ç–∞—Ä—ã–µ), –º–µ—Ç–æ–¥ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç UI. –ï—Å–ª–∏ –∑–∞–¥–∞—á –ù–ï–¢, –º–µ—Ç–æ–¥ –ø—Ä–æ—Å—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è (`return`), –ù–ï –æ—á–∏—â–∞—è UI!

```javascript
if (!activeTasks || activeTasks.length === 0) return;  // ‚ùå –ù–µ –≤—ã–∑—ã–≤–∞–µ—Ç resetParsingUI()!
```

---

## ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### Fix 1: –°–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ —Å–µ–ª–µ–∫—Ç–æ—Ä—ã –¥–ª—è –æ–±–µ–∏—Ö –∫–Ω–æ–ø–æ–∫

**–§–∞–π–ª**: `script.js:4589-4599`

**–ë—ã–ª–æ**:
```javascript
const submitBtn = document.querySelector('.submit-btn');  // ‚ùå Generic
if (submitBtn) submitBtn.style.display = 'none';
```

**–°—Ç–∞–ª–æ**:
```javascript
// ‚úÖ FIX: Use specific selectors for both buttons
const aiSearchBtn = document.querySelector('#parsingForm .submit-btn');
const urlParsingBtn = document.querySelector('#urlParsingForm .submit-btn');
const progressBar = document.getElementById('modernProgressBar');
const progressDesc = document.getElementById('progressDescription');

// Hide both submit buttons
if (aiSearchBtn) {
    aiSearchBtn.style.display = 'none';
    console.log('‚úÖ AI Search button hidden for active task');
}
if (urlParsingBtn) {
    urlParsingBtn.style.display = 'none';
    console.log('‚úÖ URL Parsing button hidden for active task');
}

// Show progress bar
if (progressBar) {
    progressBar.classList.add('active');
    console.log('‚úÖ Progress bar activated for active task');
}
if (progressDesc) {
    progressDesc.classList.add('active');
}
```

### Fix 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–æ–∑—Ä–∞—Å—Ç–∞ –∑–∞–¥–∞—á–∏ (30-–º–∏–Ω—É—Ç–Ω—ã–π timeout)

**–§–∞–π–ª**: `script.js:4565-4578`

**–î–æ–±–∞–≤–ª–µ–Ω–æ**:
```javascript
// Get the most recent active task
const activeTask = activeTasks[0];

// ‚úÖ Check if task is actually recent (within last 30 minutes)
const taskTime = new Date(activeTask.created_at).getTime();
const now = Date.now();
const thirtyMinutes = 30 * 60 * 1000;

if (now - taskTime > thirtyMinutes) {
    console.log('‚è∞ Active task is too old (>30min), not restoring UI');
    // Task is too old, likely stuck - don't restore UI
    this.resetParsingUI();
    return;
}
```

**–õ–æ–≥–∏–∫–∞**:
- –ï—Å–ª–∏ –∑–∞–¥–∞—á–∞ —Å–æ–∑–¥–∞–Ω–∞ >30 –º–∏–Ω—É—Ç –Ω–∞–∑–∞–¥ ‚Üí —Å—á–∏—Ç–∞–µ–º "–∑–∞—Å—Ç—Ä—è–≤—à–µ–π"
- –ù–ï –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º UI –¥–ª—è —Å—Ç–∞—Ä—ã—Ö –∑–∞–¥–∞—á
- –í—ã–∑—ã–≤–∞–µ–º `resetParsingUI()` –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è

### Fix 3: –ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ UI –∫–æ–≥–¥–∞ –Ω–µ—Ç –∑–∞–¥–∞—á

**–§–∞–π–ª**: `script.js:4560-4564`

**–ë—ã–ª–æ**:
```javascript
if (!activeTasks || activeTasks.length === 0) return;  // ‚ùå –ü—Ä–æ—Å—Ç–æ –≤—ã—Ö–æ–¥
```

**–°—Ç–∞–ª–æ**:
```javascript
if (!activeTasks || activeTasks.length === 0) {
    // ‚úÖ No active tasks - ensure UI is clean
    this.resetParsingUI();
    return;
}
```

### Fix 4: Fallback –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö

**–§–∞–π–ª**: `script.js:4624-4628`

**–ë—ã–ª–æ**:
```javascript
} catch (error) {
    console.warn('‚ö†Ô∏è Failed to restore active task:', error.message);
    // Don't block app initialization if restore fails
}
```

**–°—Ç–∞–ª–æ**:
```javascript
} catch (error) {
    console.warn('‚ö†Ô∏è Failed to restore active task:', error.message);
    // Ensure clean UI if restore fails
    this.resetParsingUI();
}
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –¢–µ—Å—Ç 1: –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è —Å —á–∏—Å—Ç—ã–º UI –∫–æ–≥–¥–∞ –Ω–µ—Ç –∑–∞–¥–∞—á
**–®–∞–≥–∏**:
1. –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –Ω–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞–¥–∞—á –≤ –ë–î
2. –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É (F5)
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å UI

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**:
- ‚úÖ –û–±–µ –∫–Ω–æ–ø–∫–∏ "–ù–∞—á–∞—Ç—å –ø–∞—Ä—Å–∏–Ω–≥" –≤–∏–¥–∏–º—ã (AI Search –∏ URL Parsing)
- ‚úÖ –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä —Å–∫—Ä—ã—Ç (–Ω–µ—Ç –∫–ª–∞—Å—Å–∞ 'active')
- ‚úÖ –ö–æ–Ω—Å–æ–ª—å: `‚úÖ No active tasks - ensure UI is clean`

### –¢–µ—Å—Ç 2: –°—Ç–∞—Ä—ã–µ "–∑–∞—Å—Ç—Ä—è–≤—à–∏–µ" –∑–∞–¥–∞—á–∏ –ù–ï –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è
**–®–∞–≥–∏**:
1. –°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É –≤ –ë–î —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º 'running' –∏ —Å—Ç–∞—Ä–æ–π –¥–∞—Ç–æ–π (>30 –º–∏–Ω—É—Ç)
2. –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å UI –∏ –∫–æ–Ω—Å–æ–ª—å

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**:
- ‚úÖ –û–±–µ –∫–Ω–æ–ø–∫–∏ –≤–∏–¥–∏–º—ã
- ‚úÖ –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä —Å–∫—Ä—ã—Ç
- ‚úÖ –ö–æ–Ω—Å–æ–ª—å: `‚è∞ Active task is too old (>30min), not restoring UI`

### –¢–µ—Å—Ç 3: –ù–µ–¥–∞–≤–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ
**–®–∞–≥–∏**:
1. –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø–∞—Ä—Å–∏–Ω–≥
2. –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É –°–†–ê–ó–£ (–ø–æ–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥ –∞–∫—Ç–∏–≤–µ–Ω)
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å UI

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**:
- ‚úÖ –û–ë–ï –∫–Ω–æ–ø–∫–∏ —Å–∫—Ä—ã—Ç—ã
- ‚úÖ –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä –≤–∏–¥–µ–Ω —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º
- ‚úÖ –ö–æ–Ω—Å–æ–ª—å: `‚úÖ AI Search button hidden for active task`
- ‚úÖ –ö–æ–Ω—Å–æ–ª—å: `‚úÖ URL Parsing button hidden for active task`
- ‚úÖ –ö–æ–Ω—Å–æ–ª—å: `‚úÖ Progress bar activated for active task`

### –¢–µ—Å—Ç 4: –û—à–∏–±–∫–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –Ω–µ –ª–æ–º–∞—é—Ç UI
**–®–∞–≥–∏**:
1. –°–∏–º—É–ª–∏—Ä–æ–≤–∞—Ç—å –æ—à–∏–±–∫—É API (–æ—Ç–∫–ª—é—á–∏—Ç—å —Å–µ—Ç—å –∏–ª–∏ –∏–∑–º–µ–Ω–∏—Ç—å endpoint)
2. –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å UI

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**:
- ‚úÖ –û–±–µ –∫–Ω–æ–ø–∫–∏ –≤–∏–¥–∏–º—ã (fallback –Ω–∞ `resetParsingUI()`)
- ‚úÖ –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä —Å–∫—Ä—ã—Ç
- ‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫

---

## üìä –í–ª–∏—è–Ω–∏–µ –Ω–∞ —Å–∏—Å—Ç–µ–º—É

### –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:
- ‚ùå Generic selector —Å–∫—Ä—ã–≤–∞–ª –¢–û–õ–¨–ö–û AI Search –∫–Ω–æ–ø–∫—É
- ‚ùå –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä –ø–æ–∫–∞–∑—ã–≤–∞–ª—Å—è –¥–ª—è –õ–Æ–ë–û–ô –∞–∫—Ç–∏–≤–Ω–æ–π –∑–∞–¥–∞—á–∏ (–¥–∞–∂–µ —Å—Ç–∞—Ä–æ–π)
- ‚ùå "–ó–∞—Å—Ç—Ä—è–≤—à–∏–µ" –∑–∞–¥–∞—á–∏ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–ª–∏—Å—å –ø—Ä–∏ –∫–∞–∂–¥–æ–π –∑–∞–≥—Ä—É–∑–∫–µ
- ‚ùå –ù–µ—Ç fallback –¥–ª—è —á–∏—Å—Ç–æ–≥–æ UI –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –∑–∞–¥–∞—á
- ‚ùå –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –º–æ–≥ –∑–∞–ø—É—Å—Ç–∏—Ç—å –Ω–æ–≤—ã–π –ø–∞—Ä—Å–∏–Ω–≥

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:
- ‚úÖ –°–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ —Å–µ–ª–µ–∫—Ç–æ—Ä—ã —É–ø—Ä–∞–≤–ª—è—é—Ç –û–ë–ï–ò–ú–ò –∫–Ω–æ–ø–∫–∞–º–∏
- ‚úÖ –¢–æ–ª—å–∫–æ –ù–ï–î–ê–í–ù–ò–ï –∑–∞–¥–∞—á–∏ (<30 –º–∏–Ω) –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è
- ‚úÖ –°—Ç–∞—Ä—ã–µ "–∑–∞—Å—Ç—Ä—è–≤—à–∏–µ" –∑–∞–¥–∞—á–∏ –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è
- ‚úÖ –ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ UI –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –∑–∞–¥–∞—á
- ‚úÖ Fallback –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
- ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—Å–µ–≥–¥–∞ –º–æ–∂–µ—Ç –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø–∞—Ä—Å–∏–Ω–≥

---

## üîó –°–≤—è–∑—å —Å –¥—Ä—É–≥–∏–º–∏ fixes

### AI_SEARCH_FIXES.md:
- **Fix 3**: –ò—Å–ø—Ä–∞–≤–∏–ª —Å–µ–ª–µ–∫—Ç–æ—Ä –≤ `startUrlParsing()` (`#urlParsingForm .submit-btn`)
- **–≠—Ç–æ—Ç fix**: –ò—Å–ø—Ä–∞–≤–∏–ª —Å–µ–ª–µ–∫—Ç–æ—Ä –≤ `checkAndRestoreActiveTask()` (—Ç–æ—Ç –∂–µ –ø–∞—Ç—Ç–µ—Ä–Ω)

### PROGRESS_BAR_PERSISTENCE_FIX.md:
- **–¢–æ—Ç fix**: –î–æ–±–∞–≤–∏–ª `resetParsingUI()` –≤ `switchTab()`
- **–≠—Ç–æ—Ç fix**: –î–æ–±–∞–≤–∏–ª `resetParsingUI()` –≤ `checkAndRestoreActiveTask()` –∫–∞–∫ fallback

### PROGRESS_BAR_TAB_SWITCH_FIX.md:
- **–¢–æ—Ç fix**: –ü—Ä–æ–≤–µ—Ä–∫–∞ `currentTaskId` –≤ `switchTab()` –ø–µ—Ä–µ–¥ —Å–±—Ä–æ—Å–æ–º
- **–≠—Ç–æ—Ç fix**: –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–æ–∑—Ä–∞—Å—Ç–∞ –∑–∞–¥–∞—á–∏ –ø–µ—Ä–µ–¥ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ–º `currentTaskId`

**–û–±—â–∏–π –ø–∞—Ç—Ç–µ—Ä–Ω**: –°–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ —Å–µ–ª–µ–∫—Ç–æ—Ä—ã + —É–º–Ω–∞—è –ª–æ–≥–∏–∫–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è

---

## üí° –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### 1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ "–∑–∞—Å—Ç—Ä—è–≤—à–∏—Ö" –∑–∞–¥–∞—á

–î–æ–±–∞–≤–∏—Ç—å –≤ backend cron job –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ—á–∏—Å—Ç–∫–∏:
```javascript
// –ö–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç –ø–æ–º–µ—á–∞—Ç—å —Å—Ç–∞—Ä—ã–µ 'running' –∑–∞–¥–∞—á–∏ –∫–∞–∫ 'failed'
UPDATE parsing_tasks
SET status = 'failed', error = 'Task timeout - exceeded 30 minutes'
WHERE status = 'running'
  AND created_at < NOW() - INTERVAL '30 minutes'
```

### 2. Heartbeat –¥–ª—è –∞–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞–¥–∞—á

–ü–∞—Ä—Å–∏–Ω–≥ –¥–æ–ª–∂–µ–Ω –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å "–∂–∏–≤–æ–π" —Å–∏–≥–Ω–∞–ª:
```javascript
setInterval(async () => {
    if (this.currentTaskId) {
        await fetch(`/api/parsing-tasks/${this.currentTaskId}/heartbeat`, {
            method: 'POST'
        });
    }
}, 60000); // –ö–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É
```

### 3. –í–∏–∑—É–∞–ª—å–Ω—ã–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á

–ü—Ä–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–∏ –ø–æ–∫–∞–∑–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ:
```javascript
this.showNotification('üîÑ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∞–∫—Ç–∏–≤–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥', 'info');
```

---

## üéØ Summary

**–ü—Ä–æ–±–ª–µ–º—ã**:
1. –ö–Ω–æ–ø–∫–∞ "–ù–∞—á–∞—Ç—å –ø–∞—Ä—Å–∏–Ω–≥" –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
2. –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –≤–∏–¥–µ–Ω –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏
3. Generic selector —Å–∫—Ä—ã–≤–∞–ª —Ç–æ–ª—å–∫–æ –æ–¥–Ω—É –∫–Ω–æ–ø–∫—É

**Root Causes**:
1. `checkAndRestoreActiveTask()` –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª generic selector `.submit-btn`
2. –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–ª–∏—Å—å –õ–Æ–ë–´–ï –∞–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏ (–¥–∞–∂–µ "–∑–∞—Å—Ç—Ä—è–≤—à–∏–µ" —Å—Ç–∞—Ä—ã–µ)
3. –ù–µ—Ç fallback –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ UI –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –∑–∞–¥–∞—á

**–†–µ—à–µ–Ω–∏—è**:
1. ‚úÖ –°–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ —Å–µ–ª–µ–∫—Ç–æ—Ä—ã –¥–ª—è –æ–±–µ–∏—Ö –∫–Ω–æ–ø–æ–∫ (`#parsingForm .submit-btn`, `#urlParsingForm .submit-btn`)
2. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–æ–∑—Ä–∞—Å—Ç–∞ –∑–∞–¥–∞—á–∏ (<30 –º–∏–Ω—É—Ç –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è)
3. ‚úÖ –í—ã–∑–æ–≤ `resetParsingUI()` –∫–æ–≥–¥–∞ –Ω–µ—Ç –∑–∞–¥–∞—á –∏–ª–∏ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
4. ‚úÖ –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

**–†–µ–∑—É–ª—å—Ç–∞—Ç**:
- ‚úÖ –û–±–µ –∫–Ω–æ–ø–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —É–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
- ‚úÖ –¢–æ–ª—å–∫–æ –Ω–µ–¥–∞–≤–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è
- ‚úÖ –°—Ç–∞—Ä—ã–µ "–∑–∞—Å—Ç—Ä—è–≤—à–∏–µ" –∑–∞–¥–∞—á–∏ –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è
- ‚úÖ –ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —á–∏—Å—Ç–æ–µ UI –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –∑–∞–¥–∞—á

**–î–∞—Ç–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è**: 2025-10-01
**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: –¢—Ä–µ–±—É–µ—Ç—Å—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º
**–ö–æ–º–º–∏—Ç**: –ì–æ—Ç–æ–≤ –∫ push
