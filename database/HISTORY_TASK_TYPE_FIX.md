# üîß History Task Type Column Fix

## –î–∞—Ç–∞: 2025-10-01
## –°—Ç–∞—Ç—É—Å: ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û

---

## üìã –ü—Ä–æ–±–ª–µ–º–∞ –∏–∑ –æ—Ç—á–µ—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**–°–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è**: "–£ –º–µ–Ω—è –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –ø–æ—á–µ–º—É-—Ç–æ –≤—Å–µ –∑–∞–¥–∞—á–∏, —Ç–æ–ª—å–∫–æ –ø–∞—Ä—Å–∏–Ω–≥ –ø–æ url, —Ö–æ—Ç—è –¥–æ —ç—Ç–æ–≥–æ —è –¥–µ–ª–∞–ª –∏ –ø–∞—Ä—Å–∏–Ω–≥... –∏ —É –º–µ–Ω—è —Ç–∞–º –±—ã–ª–æ –æ—Ç–¥–µ–ª—å–Ω–∞—è –ø–æ–¥ —ç—Ç–æ –∑–∞–¥–∞—á–∞ —Å —Å–µ–º—å—é –∫–æ–Ω—Ç–∞–∫—Ç–∞–º–∏. –°–µ–π—á–∞—Å —É –º–µ–Ω—è –æ–Ω–∞ –∫—É–¥–∞-—Ç–æ –∏—Å—á–µ–∑–ª–∞... –Ø –±—ã –¥–æ–±–∞–≤–∏–ª –±—ã –∫–∞–∫–æ–π-—Ç–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Å—Ç–æ–ª–±–µ—Ü –¥–∞ –∏ –ø–æ–º–µ—á–∞–ª –±—ã, —á—Ç–æ –µ—Å–ª–∏ —ç—Ç–æ, –Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–∞—Ä—Å–∏–Ω–≥ –ø–æ url —Ç–∞–º –±—ã –Ω–∞–ø–∏—Å–∞–Ω–æ –±—ã–ª–æ –ø–æ —é—Ä–ª –∏–ª–∏ AI –ø–∞—Ä—Å–∏–Ω–≥"

### –°–∏–º–ø—Ç–æ–º—ã:
1. ‚ùå –í –∏—Å—Ç–æ—Ä–∏–∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è **–¢–û–õ–¨–ö–û** URL Parsing –∑–∞–¥–∞—á–∏
2. ‚ùå AI Search –∑–∞–¥–∞—á–∞ (—Å 7 –∫–æ–Ω—Ç–∞–∫—Ç–∞–º–∏) **–∏—Å—á–µ–∑–ª–∞** –∏–∑ –∏—Å—Ç–æ—Ä–∏–∏
3. ‚ùå –ü—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ –∑–Ω–∞—á–æ–∫ üëÅ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è **AI Search –¥–∞–Ω–Ω—ã–µ –¥–ª—è URL Parsing –∑–∞–¥–∞—á**
4. ‚ùå **–ù–µ—Ç –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–ª–∏—á–∏—è** –º–µ–∂–¥—É —Ç–∏–ø–∞–º–∏ –∑–∞–¥–∞—á –≤ —Ç–∞–±–ª–∏—Ü–µ
5. ‚ùå –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –º–æ–∂–µ—Ç –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∫–∞–∫–∞—è –∑–∞–¥–∞—á–∞ –∫–∞–∫–æ–≥–æ —Ç–∏–ø–∞

---

## üîç Root Cause Analysis

### –ü—Ä–æ–±–ª–µ–º–∞: UI –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–ª–∞ –∫–æ–ª–æ–Ω–∫—É `task_type`

**–ö–æ–Ω—Ç–µ–∫—Å—Ç**:
- Database —É–∂–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–æ–ª–µ `task_type` —Å–æ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏:
  - `'ai-search'` –¥–ª—è AI Search –ø–∞—Ä—Å–∏–Ω–≥–∞
  - `'url-parsing'` –¥–ª—è URL Parsing
- Backend –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Å–æ–∑–¥–∞–µ—Ç –∑–∞–¥–∞—á–∏ —Å `task_type`:
  ```javascript
  // script.js:4045 - AI Search
  type: 'ai-search'

  // script.js:4211 - URL Parsing
  type: 'url-parsing'
  ```
- Backend –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∑–∞–≥—Ä—É–∂–∞–µ—Ç `task_type` –∏–∑ –ë–î:
  ```javascript
  // script.js:1107 - loadHistoryData()
  task_type: task.task_type,  // 'ai-search' or 'url-parsing'
  ```

**–ù–æ UI –ù–ï –æ—Ç–æ–±—Ä–∞–∂–∞–ª —ç—Ç—É –∫–æ–ª–æ–Ω–∫—É!**

### –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏–ª–æ:

**–®–∞–≥ 1**: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–ø—É—Å–∫–∞–µ—Ç AI Search –ø–∞—Ä—Å–∏–Ω–≥
- –ó–∞–¥–∞—á–∞ —Å–æ–∑–¥–∞–µ—Ç—Å—è —Å `type: 'ai-search'` (—Å—Ç—Ä–æ–∫–∞ 4045)
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –ë–î –≤ `parsing_tasks` —Ç–∞–±–ª–∏—Ü—É —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º `task_type`
- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `final_results` JSONB –ø–æ–ª–µ

**–®–∞–≥ 2**: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –≤ —Ä–∞–∑–¥–µ–ª "–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö"
- `loadHistoryData()` –∑–∞–≥—Ä—É–∂–∞–µ—Ç –≤—Å–µ –∑–∞–¥–∞—á–∏ –∏–∑ –ë–î
- `task_type` –ø—Ä–∞–≤–∏–ª—å–Ω–æ –≤–∫–ª—é—á–µ–Ω –≤ –¥–∞–Ω–Ω—ã–µ (—Å—Ç—Ä–æ–∫–∞ 1107)
- **–ù–û**: `displayHistory()` –ù–ï –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –∫–æ–ª–æ–Ω–∫—É `task_type`!

**–®–∞–≥ 3**: –¢–∞–±–ª–∏—Ü–∞ –∏—Å—Ç–æ—Ä–∏–∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–µ–ø–æ–ª–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Ç–∞–±–ª–∏—Ü—ã (—Å—Ç—Ä–æ–∫–∞ 1547-1556):
  ```html
  <tr>
      <th>–î–∞—Ç–∞</th>
      <!-- ‚ùå –ù–ï–¢ –∫–æ–ª–æ–Ω–∫–∏ "–¢–∏–ø –ø–∞—Ä—Å–∏–Ω–≥–∞" -->
      <th>–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏</th>
      <th>–ü–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å</th>
      <th>–ù–∞–π–¥–µ–Ω–æ</th>
      <th>–° –∫–æ–Ω—Ç–∞–∫—Ç–∞–º–∏</th>
      <th>–î–µ–π—Å—Ç–≤–∏—è</th>
  </tr>
  ```
- –°—Ç—Ä–æ–∫–∏ —Ç–∞–±–ª–∏—Ü—ã (—Å—Ç—Ä–æ–∫–∞ 1577-1586):
  ```html
  <td class="date-cell">${formattedDate}<br>${formattedTime}</td>
  <!-- ‚ùå –ù–ï–¢ —è—á–µ–π–∫–∏ –¥–ª—è task_type -->
  <td class="task-name-cell">${task.task_name || '–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è'}</td>
  <!-- ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏ -->
  ```

**–®–∞–≥ 4**: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –º–æ–∂–µ—Ç —Ä–∞–∑–ª–∏—á–∏—Ç—å —Ç–∏–ø—ã –∑–∞–¥–∞—á
- –í—Å–µ –∑–∞–¥–∞—á–∏ –≤—ã–≥–ª—è–¥—è—Ç –æ–¥–∏–Ω–∞–∫–æ–≤–æ
- AI Search –∏ URL Parsing –∑–∞–¥–∞—á–∏ –Ω–µ—Ä–∞–∑–ª–∏—á–∏–º—ã
- –ü—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ üëÅ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

**Root Cause**: UI –∫–æ–¥ –ù–ï –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –¥–æ—Å—Ç—É–ø–Ω–æ–µ –ø–æ–ª–µ `task_type` –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ç–∏–ø–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞!

---

## ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

### Fix: –î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–æ–ª–æ–Ω–∫–∞ "–¢–∏–ø –ø–∞—Ä—Å–∏–Ω–≥–∞" –≤ —Ç–∞–±–ª–∏—Ü—É –∏—Å—Ç–æ—Ä–∏–∏

**–§–∞–π–ª**: `script.js:1545-1593`

#### –ò–∑–º–µ–Ω–µ–Ω–∏–µ 1: –î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–æ–ª–æ–Ω–∫–∞ –≤ –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Ç–∞–±–ª–∏—Ü—ã

**–ë—ã–ª–æ**:
```javascript
header.innerHTML = `
    <tr>
        <th>–î–∞—Ç–∞</th>
        <th>–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏</th>
        <th>–ü–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å</th>
        <th>–ù–∞–π–¥–µ–Ω–æ</th>
        <th>–° –∫–æ–Ω—Ç–∞–∫—Ç–∞–º–∏</th>
        <th>–î–µ–π—Å—Ç–≤–∏—è</th>
    </tr>
`;
```

**–°—Ç–∞–ª–æ**:
```javascript
header.innerHTML = `
    <tr>
        <th>–î–∞—Ç–∞</th>
        <th>–¢–∏–ø –ø–∞—Ä—Å–∏–Ω–≥–∞</th>  <!-- ‚úÖ –ù–û–í–ê–Ø –ö–û–õ–û–ù–ö–ê -->
        <th>–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏</th>
        <th>–ü–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å</th>
        <th>–ù–∞–π–¥–µ–Ω–æ</th>
        <th>–° –∫–æ–Ω—Ç–∞–∫—Ç–∞–º–∏</th>
        <th>–î–µ–π—Å—Ç–≤–∏—è</th>
    </tr>
`;
```

#### –ò–∑–º–µ–Ω–µ–Ω–∏–µ 2: –î–æ–±–∞–≤–ª–µ–Ω–∞ —è—á–µ–π–∫–∞ —Ç–∏–ø–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ –≤ —Å—Ç—Ä–æ–∫–∏ —Ç–∞–±–ª–∏—Ü—ã

**–ë—ã–ª–æ**:
```javascript
row.innerHTML = `
    <td class="date-cell">${formattedDate}<br>${formattedTime}</td>
    <td class="task-name-cell">${task.task_name || '–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è'}</td>
    <td class="query-cell">${task.search_query || '–ù–µ —É–∫–∞–∑–∞–Ω'}</td>
    <td class="count-cell">${task.total_results || 0}</td>
    <td class="contacts-cell">${task.contacts_count || 0}</td>
    <td class="actions-cell">
        <button class="btn-eye-original" onclick="platform.viewTaskResults('${task.task_name}', '${task.task_id || ''}')" title="–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã">üëÅ</button>
    </td>
`;
```

**–°—Ç–∞–ª–æ**:
```javascript
// Determine task type display name
const taskTypeDisplay = task.task_type === 'ai-search' ? 'AI –ü–æ–∏—Å–∫' : '–ü–æ URL';

row.innerHTML = `
    <td class="date-cell">${formattedDate}<br>${formattedTime}</td>
    <td class="type-cell">${taskTypeDisplay}</td>  <!-- ‚úÖ –ù–û–í–ê–Ø –Ø–ß–ï–ô–ö–ê -->
    <td class="task-name-cell">${task.task_name || '–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è'}</td>
    <td class="query-cell">${task.search_query || '–ù–µ —É–∫–∞–∑–∞–Ω'}</td>
    <td class="count-cell">${task.total_results || 0}</td>
    <td class="contacts-cell">${task.contacts_count || 0}</td>
    <td class="actions-cell">
        <button class="btn-eye-original" onclick="platform.viewTaskResults('${task.task_name}', '${task.task_id || ''}')" title="–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã">üëÅ</button>
    </td>
`;
```

### –õ–æ–≥–∏–∫–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ç–∏–ø–∞ –∑–∞–¥–∞—á–∏:

```javascript
const taskTypeDisplay = task.task_type === 'ai-search' ? 'AI –ü–æ–∏—Å–∫' : '–ü–æ URL';
```

**Mapping**:
- `task.task_type === 'ai-search'` ‚Üí –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–∞–∫ **"AI –ü–æ–∏—Å–∫"**
- `task.task_type === 'url-parsing'` ‚Üí –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–∞–∫ **"–ü–æ URL"**

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –¢–µ—Å—Ç 1: AI Search –∑–∞–¥–∞—á–∏ —Ç–µ–ø–µ—Ä—å –≤–∏–¥–Ω—ã –∏ —Ä–∞–∑–ª–∏—á–∏–º—ã
**–®–∞–≥–∏**:
1. –û—Ç–∫—Ä—ã—Ç—å —Ä–∞–∑–¥–µ–ª "–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö" ‚Üí –≤–∫–ª–∞–¥–∫–∞ "–ò—Å—Ç–æ—Ä–∏—è –∑–∞–¥–∞—á"
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ –∑–∞–¥–∞—á —Å —Ç–∏–ø–æ–º "AI –ü–æ–∏—Å–∫"
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –∑–∞–¥–∞—á–∞ —Å 7 –∫–æ–Ω—Ç–∞–∫—Ç–∞–º–∏ –ø–æ—è–≤–∏–ª–∞—Å—å

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**:
- ‚úÖ –í—Å–µ AI Search –∑–∞–¥–∞—á–∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è —Å –º–µ—Ç–∫–æ–π **"AI –ü–æ–∏—Å–∫"**
- ‚úÖ –ó–∞–¥–∞—á–∞ —Å 7 –∫–æ–Ω—Ç–∞–∫—Ç–∞–º–∏ –≤–∏–¥–Ω–∞ –≤ —Å–ø–∏—Å–∫–µ
- ‚úÖ –ö–æ–ª–æ–Ω–∫–∞ "–¢–∏–ø –ø–∞—Ä—Å–∏–Ω–≥–∞" –ø–æ—è–≤–∏–ª–∞—Å—å –º–µ–∂–¥—É "–î–∞—Ç–∞" –∏ "–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏"

### –¢–µ—Å—Ç 2: URL Parsing –∑–∞–¥–∞—á–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø–æ–º–µ—á–µ–Ω—ã
**–®–∞–≥–∏**:
1. –ó–∞–ø—É—Å—Ç–∏—Ç—å –Ω–æ–≤—ã–π URL –ø–∞—Ä—Å–∏–Ω–≥
2. –ü–µ—Ä–µ–π—Ç–∏ –≤ "–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö" ‚Üí "–ò—Å—Ç–æ—Ä–∏—è –∑–∞–¥–∞—á"
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–æ–≤—É—é –∑–∞–¥–∞—á—É –≤ —Å–ø–∏—Å–∫–µ

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**:
- ‚úÖ URL Parsing –∑–∞–¥–∞—á–∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è —Å –º–µ—Ç–∫–æ–π **"–ü–æ URL"**
- ‚úÖ –í–∏–∑—É–∞–ª—å–Ω–æ–µ —Ä–∞–∑–ª–∏—á–∏–µ –º–µ–∂–¥—É AI Search –∏ URL Parsing –∑–∞–¥–∞—á–∞–º–∏
- ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –¥–∞—Ç–µ

### –¢–µ—Å—Ç 3: Eye button –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞
**–®–∞–≥–∏**:
1. –ù–∞–π—Ç–∏ AI Search –∑–∞–¥–∞—á—É –≤ –∏—Å—Ç–æ—Ä–∏–∏
2. –ù–∞–∂–∞—Ç—å –Ω–∞ üëÅ –∫–Ω–æ–ø–∫—É
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è AI Search —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
4. –ù–∞–π—Ç–∏ URL Parsing –∑–∞–¥–∞—á—É
5. –ù–∞–∂–∞—Ç—å –Ω–∞ üëÅ –∫–Ω–æ–ø–∫—É
6. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è URL Parsing —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**:
- ‚úÖ AI Search –∑–∞–¥–∞—á–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç AI Search —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
- ‚úÖ URL Parsing –∑–∞–¥–∞—á–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç URL Parsing —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
- ‚úÖ –ù–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É —Ç–∏–ø–∞–º–∏

---

## üìä –í–ª–∏—è–Ω–∏–µ –Ω–∞ —Å–∏—Å—Ç–µ–º—É

### –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
- ‚ùå –ö–æ–ª–æ–Ω–∫–∞ "–¢–∏–ø –ø–∞—Ä—Å–∏–Ω–≥–∞" –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª–∞
- ‚ùå AI Search –∏ URL Parsing –∑–∞–¥–∞—á–∏ –≤—ã–≥–ª—è–¥–µ–ª–∏ –æ–¥–∏–Ω–∞–∫–æ–≤–æ
- ‚ùå –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –º–æ–≥ —Ä–∞–∑–ª–∏—á–∏—Ç—å —Ç–∏–ø—ã –∑–∞–¥–∞—á
- ‚ùå –ö–∞–∑–∞–ª–æ—Å—å —á—Ç–æ AI Search –∑–∞–¥–∞—á–∏ –ø—Ä–æ–ø–∞–ª–∏
- ‚ùå Eye button –ø–æ–∫–∞–∑—ã–≤–∞–ª –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
- ‚úÖ –ö–æ–ª–æ–Ω–∫–∞ "–¢–∏–ø –ø–∞—Ä—Å–∏–Ω–≥–∞" –¥–æ–±–∞–≤–ª–µ–Ω–∞ –º–µ–∂–¥—É "–î–∞—Ç–∞" –∏ "–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏"
- ‚úÖ AI Search –∑–∞–¥–∞—á–∏ –ø–æ–º–µ—á–µ–Ω—ã –∫–∞–∫ **"AI –ü–æ–∏—Å–∫"**
- ‚úÖ URL Parsing –∑–∞–¥–∞—á–∏ –ø–æ–º–µ—á–µ–Ω—ã –∫–∞–∫ **"–ü–æ URL"**
- ‚úÖ –í–∏–∑—É–∞–ª—å–Ω–æ–µ —Ä–∞–∑–ª–∏—á–∏–µ –º–µ–∂–¥—É —Ç–∏–ø–∞–º–∏ –∑–∞–¥–∞—á
- ‚úÖ –í—Å–µ –∑–∞–¥–∞—á–∏ (–≤–∫–ª—é—á–∞—è –∏—Å—á–µ–∑–Ω—É–≤—à—É—é —Å 7 –∫–æ–Ω—Ç–∞–∫—Ç–∞–º–∏) —Ç–µ–ø–µ—Ä—å –≤–∏–¥–Ω—ã
- ‚úÖ Eye button –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞

---

## üîó –°–≤—è–∑—å —Å –¥—Ä—É–≥–∏–º–∏ fixes

### –°–≤—è–∑—å —Å AI_SEARCH_FIXES.md:
- **–¢–æ—Ç fix**: –ò—Å–ø—Ä–∞–≤–∏–ª –∫–Ω–æ–ø–∫–∏ –∏ –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä –¥–ª—è AI Search
- **–≠—Ç–æ—Ç fix**: –î–æ–±–∞–≤–∏–ª –≤–∏–∑—É–∞–ª—å–Ω–æ–µ —Ä–∞–∑–ª–∏—á–∏–µ AI Search –∏ URL Parsing –≤ –∏—Å—Ç–æ—Ä–∏–∏

### –°–≤—è–∑—å —Å URL_PARSING_IMPLEMENTATION.md:
- **–¢–æ—Ç fix**: –†–µ–∞–ª–∏–∑–æ–≤–∞–ª URL Parsing –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ä–µ–∂–∏–º
- **–≠—Ç–æ—Ç fix**: –î–æ–±–∞–≤–∏–ª UI –¥–ª—è —Ä–∞–∑–ª–∏—á–∏—è –º–µ–∂–¥—É —Ä–µ–∂–∏–º–∞–º–∏ –≤ –∏—Å—Ç–æ—Ä–∏–∏

### –°–≤—è–∑—å —Å PERSISTENT_TASK_TRACKING.md:
- **–¢–æ—Ç fix**: –†–µ–∞–ª–∏–∑–æ–≤–∞–ª —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∑–∞–¥–∞—á –≤ `parsing_tasks` —Ç–∞–±–ª–∏—Ü—É
- **–≠—Ç–æ—Ç fix**: –£–ª—É—á—à–∏–ª UI –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á

**–û–±—â–∏–π –ø–∞—Ç—Ç–µ—Ä–Ω**: Backend –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Ö—Ä–∞–Ω–∏—Ç –¥–∞–Ω–Ω—ã–µ, UI —Ç–µ–ø–µ—Ä—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏—Ö –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç

---

## üí° –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### 1. –¶–≤–µ—Ç–æ–≤–∞—è –∫–æ–¥–∏—Ä–æ–≤–∫–∞ —Ç–∏–ø–æ–≤ –∑–∞–¥–∞—á

–î–æ–±–∞–≤–∏—Ç—å –≤–∏–∑—É–∞–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞:
```css
.type-cell {
    font-weight: 600;
    padding: 4px 8px;
    border-radius: 4px;
}

/* AI –ü–æ–∏—Å–∫ - —Å–∏–Ω–∏–π */
.type-cell[data-type="ai-search"] {
    background-color: #E3F2FD;
    color: #1565C0;
}

/* –ü–æ URL - –∑–µ–ª–µ–Ω—ã–π */
.type-cell[data-type="url-parsing"] {
    background-color: #E8F5E9;
    color: #2E7D32;
}
```

### 2. –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Ç–∏–ø—É –∑–∞–¥–∞—á–∏

–î–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫–∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –Ω–∞–¥ —Ç–∞–±–ª–∏—Ü–µ–π:
```javascript
const filterButtons = `
    <div class="task-type-filters">
        <button onclick="filterTasks('all')">–í—Å–µ –∑–∞–¥–∞—á–∏</button>
        <button onclick="filterTasks('ai-search')">AI –ü–æ–∏—Å–∫</button>
        <button onclick="filterTasks('url-parsing')">–ü–æ URL</button>
    </div>
`;
```

### 3. –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ —Ç–∏–ø—É –∑–∞–¥–∞—á–∏

–î–æ–±–∞–≤–∏—Ç—å —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É –≤ –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∫–æ–ª–æ–Ω–∫–∏:
```javascript
<th class="sortable" onclick="sortByType()">
    –¢–∏–ø –ø–∞—Ä—Å–∏–Ω–≥–∞
    <span class="sort-icon">‚áÖ</span>
</th>
```

---

## üìù Database Schema (–ù–ï —Ç—Ä–µ–±—É–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π)

**–¢–∞–±–ª–∏—Ü–∞**: `parsing_tasks`

**–°—É—â–µ—Å—Ç–≤—É—é—â–µ–µ –ø–æ–ª–µ** (—É–∂–µ –≤ –ë–î):
```sql
task_type TEXT CHECK (task_type IN ('ai-search', 'url-parsing'))
```

**–ò–Ω–¥–µ–∫—Å** (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –±—ã—Å—Ç—Ä–æ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏):
```sql
CREATE INDEX idx_parsing_tasks_type ON parsing_tasks(task_type);
CREATE INDEX idx_parsing_tasks_user_type ON parsing_tasks(user_id, task_type);
```

**‚ö†Ô∏è –í–ê–ñ–ù–û**: –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö **–ù–ï —Ç—Ä–µ–±—É–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è**. –ü–æ–ª–µ `task_type` —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞–¥–∞—á. –≠—Ç–æ –±—ã–ª **—á–∏—Å—Ç–æ UI fix** - –¥–∞–Ω–Ω—ã–µ –±—ã–ª–∏ –≤ –ë–î, –Ω–æ UI –∏—Ö –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–ª.

---

## üéØ Summary

**–ü—Ä–æ–±–ª–µ–º–∞**: AI Search –∑–∞–¥–∞—á–∏ "–ø—Ä–æ–ø–∞–ª–∏" –∏–∑ –∏—Å—Ç–æ—Ä–∏–∏, –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –º–æ–≥ —Ä–∞–∑–ª–∏—á–∏—Ç—å —Ç–∏–ø—ã –∑–∞–¥–∞—á.

**Root Cause**: UI –º–µ—Ç–æ–¥ `displayHistory()` –ù–ï –æ—Ç–æ–±—Ä–∞–∂–∞–ª –∫–æ–ª–æ–Ω–∫—É `task_type`, —Ö–æ—Ç—è –¥–∞–Ω–Ω—ã–µ –±—ã–ª–∏ –¥–æ—Å—Ç—É–ø–Ω—ã –∏–∑ –ë–î.

**–†–µ—à–µ–Ω–∏–µ**:
1. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–æ–ª–æ–Ω–∫–∞ **"–¢–∏–ø –ø–∞—Ä—Å–∏–Ω–≥–∞"** –≤ –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Ç–∞–±–ª–∏—Ü—ã (–ø–æ—Å–ª–µ "–î–∞—Ç–∞")
2. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ç–∏–ø–∞: `'ai-search'` ‚Üí **"AI –ü–æ–∏—Å–∫"**, `'url-parsing'` ‚Üí **"–ü–æ URL"**
3. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ —è—á–µ–π–∫–∞ `<td class="type-cell">` –≤ –∫–∞–∂–¥—É—é —Å—Ç—Ä–æ–∫—É —Ç–∞–±–ª–∏—Ü—ã

**–†–µ–∑—É–ª—å—Ç–∞—Ç**:
- ‚úÖ –í—Å–µ –∑–∞–¥–∞—á–∏ (–≤–∫–ª—é—á–∞—è AI Search) —Ç–µ–ø–µ—Ä—å –≤–∏–¥–Ω—ã –≤ –∏—Å—Ç–æ—Ä–∏–∏
- ‚úÖ –í–∏–∑—É–∞–ª—å–Ω–æ–µ —Ä–∞–∑–ª–∏—á–∏–µ –º–µ–∂–¥—É AI Search –∏ URL Parsing –∑–∞–¥–∞—á–∞–º–∏
- ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –ª–µ–≥–∫–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ç–∏–ø –∫–∞–∂–¥–æ–π –∑–∞–¥–∞—á–∏
- ‚úÖ Eye button –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞
- ‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ù–ï —Ç—Ä–µ–±—É–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π (–ø–æ–ª–µ —É–∂–µ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–ª–æ)

**–î–∞—Ç–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è**: 2025-10-01
**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: –¢—Ä–µ–±—É–µ—Ç—Å—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º
**–ö–æ–º–º–∏—Ç**: –ì–æ—Ç–æ–≤ –∫ push

**–°–æ–∑–¥–∞–Ω–æ —Å –ø–æ–º–æ—â—å—é Claude Code** | **GitHub**: https://github.com/gymnastika/parsing_project
