# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: –≠–∫—Å–ø–æ—Ä—Ç –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ –≤ CSV

**–î–∞—Ç–∞**: 1 –æ–∫—Ç—è–±—Ä—è 2025
**–ü—Ä–æ–±–ª–µ–º–∞**: –ö–Ω–æ–ø–∫–∞ "–≠–∫—Å–ø–æ—Ä—Ç –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤" –Ω–µ —Ä–∞–±–æ—Ç–∞–ª–∞ –∏–ª–∏ CSV —Ñ–∞–π–ª –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞–ª –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–π —Ç–∞–±–ª–∏—Ü–µ

---

## üîç –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º—ã

### –ß—Ç–æ —Å–æ–æ–±—â–∏–ª –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:
- ‚ùå –ö–Ω–æ–ø–∫–∞ "–≠–∫—Å–ø–æ—Ä—Ç –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤" –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- üìä –í —Ä–∞–∑–¥–µ–ª–µ –ö–æ–Ω—Ç–∞–∫—Ç—ã –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –¥–∞–Ω–Ω—ã–µ
- üìÅ –ù—É–∂–µ–Ω CSV/Excel —Å —Ç–µ–º–∏ –∂–µ —Å—Ç–æ–ª–±—Ü–∞–º–∏ –∏ –¥–∞–Ω–Ω—ã–º–∏, —á—Ç–æ –≤ —Ç–∞–±–ª–∏—Ü–µ

### Root Cause (–ö–æ—Ä–Ω–µ–≤–∞—è –ø—Ä–∏—á–∏–Ω–∞):

**–ü—Ä–æ–±–ª–µ–º–∞**: Event listener –±—ã–ª –ø—Ä–∏–≤—è–∑–∞–Ω (`bindExportContacts()` –≤—ã–∑—ã–≤–∞–ª—Å—è), –Ω–æ –ª–æ–≥–∏–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞ –Ω–µ –±—ã–ª–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ —Å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º —Ç–∞–±–ª–∏—Ü—ã.

**–î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ:**

1. **–¢–∞–±–ª–∏—Ü–∞ –ö–æ–Ω—Ç–∞–∫—Ç–æ–≤ –æ—Ç–æ–±—Ä–∞–∂–∞–ª–∞ 6 —Å—Ç–æ–ª–±—Ü–æ–≤:**
   ```javascript
   // displayContacts() —Å—Ç—Ä–æ–∫–∏ 2013-2025
   ['–ö–∞—Ç–µ–≥–æ—Ä–∏—è', '–ù–∞–∑–≤–∞–Ω–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏', 'Email', '–û–ø–∏—Å–∞–Ω–∏–µ', '–í–µ–±-—Å–∞–π—Ç', '–î–∞—Ç–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è']
   ```

2. **CSV —ç–∫—Å–ø–æ—Ä—Ç –∏–º–µ–ª —Ç–µ –∂–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏, –ù–û:**
   - –ù–µ –ø—Ä–∏–º–µ–Ω—è–ª–∞—Å—å —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –¥–∞—Ç–µ (–≤ —Ç–∞–±–ª–∏—Ü–µ –±—ã–ª–∞)
   - –ù–µ –±—ã–ª–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–± —É—Å–ø–µ—à–Ω–æ–º —ç–∫—Å–ø–æ—Ä—Ç–µ
   - –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –Ω–µ —É–∫–∞–∑—ã–≤–∞–ª–∏ –Ω–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é —Å `displayContacts()`

3. **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –±—ã–ª –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π, –Ω–æ –Ω–µ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω

---

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

### –£–ª—É—á—à–µ–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞ (script.js:3209-3314):

```javascript
// Export contacts to CSV file - matches Contacts table display
exportContactsToCSV() {
    console.log('üì• Exporting contacts to CSV...');

    try {
        // Get categories from cache
        const categories = this.getCacheData('categories_map') || [];

        // Get contacts from cache
        let contacts = this.getCacheData('contacts_data') || [];

        if (contacts.length === 0) {
            alert('–ù–µ—Ç –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –ø–∞—Ä—Å–∏–Ω–≥ —Å–Ω–∞—á–∞–ª–∞.');
            return;
        }

        // Check if category filter is active
        const filterSelect = document.getElementById('contactsCategoryFilter');
        const categoryId = filterSelect ? filterSelect.value : '';

        // Apply filter if category is selected
        if (categoryId) {
            contacts = contacts.filter(contact => contact.category_id === categoryId);
            console.log(`üìã Filtered to ${contacts.length} contacts for category ${categoryId}`);
        }

        if (contacts.length === 0) {
            alert('–ù–µ—Ç –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞ —Å –≤—ã–±—Ä–∞–Ω–Ω—ã–º —Ñ–∏–ª—å—Ç—Ä–æ–º.');
            return;
        }

        // üìÖ Sort contacts by date before export (match table display)
        const sortedContacts = this.sortContactsByDate([...contacts], this.dateSortDirection || 'desc');

        // CSV header - EXACT match with displayContacts() table columns
        const headers = ['–ö–∞—Ç–µ–≥–æ—Ä–∏—è', '–ù–∞–∑–≤–∞–Ω–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏', 'Email', '–û–ø–∏—Å–∞–Ω–∏–µ', '–í–µ–±-—Å–∞–π—Ç', '–î–∞—Ç–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è'];

        // Helper function to escape CSV values
        const escapeCSV = (value) => {
            if (value == null || value === '') return '';
            const stringValue = String(value);
            // Escape double quotes and wrap in quotes if contains comma, quote, or newline
            if (stringValue.includes(',') || stringValue.includes('"') || stringValue.includes('\n')) {
                return `"${stringValue.replace(/"/g, '""')}"`;
            }
            return stringValue;
        };

        // Build CSV rows - EXACT match with displayContacts() row structure
        const rows = sortedContacts.map(contact => {
            // Get category name (same logic as displayContacts)
            const category = categories.find(c => c.id === contact.category_id);
            const categoryName = category ? category.name : (contact.category_id ? '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ' : '–ë–µ–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏');

            // Format date (same format as displayContacts: dd.mm.yy)
            const dateObj = new Date(contact.parsing_timestamp || contact.created_at || new Date());
            const formattedDate = dateObj.toLocaleDateString('ru-RU', {
                day: '2-digit',
                month: '2-digit',
                year: '2-digit'
            });

            return [
                escapeCSV(categoryName),
                escapeCSV(contact.organization_name || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è'),
                escapeCSV(contact.email || '–ù–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω'),
                escapeCSV(contact.description || '–û–ø–∏—Å–∞–Ω–∏–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç'),
                escapeCSV(contact.website || '–ù–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω'),
                escapeCSV(formattedDate)
            ].join(',');
        });

        // Combine header and rows
        const csvContent = [headers.join(','), ...rows].join('\n');

        // Add UTF-8 BOM for Excel compatibility with Cyrillic
        const BOM = '\uFEFF';
        const csvWithBOM = BOM + csvContent;

        // Create blob and download
        const blob = new Blob([csvWithBOM], { type: 'text/csv;charset=utf-8;' });
        const link = document.createElement('a');

        // Generate filename with timestamp
        const timestamp = new Date().toISOString().slice(0, 19).replace('T', '_').replace(/:/g, '-');
        const filename = `contacts_${timestamp}.csv`;

        link.href = URL.createObjectURL(blob);
        link.download = filename;
        link.style.display = 'none';

        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);

        // Clean up object URL
        setTimeout(() => URL.revokeObjectURL(link.href), 100);

        console.log(`‚úÖ Exported ${sortedContacts.length} contacts to ${filename}`);
        alert(`‚úÖ –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ ${sortedContacts.length} –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ –≤ —Ñ–∞–π–ª ${filename}`);

    } catch (error) {
        console.error('‚ùå Error exporting contacts:', error);
        alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ —ç–∫—Å–ø–æ—Ä—Ç–µ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –¥–ª—è –¥–µ—Ç–∞–ª–µ–π.');
    }
}
```

### –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å:

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è | –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è |
|----------|----------------|-------------------|
| –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ | –ù–µ –ø—Ä–∏–º–µ–Ω—è–ª–∞—Å—å | –ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è `sortContactsByDate()` |
| –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ | –¢–æ–ª—å–∫–æ –≤ –∫–æ–Ω—Å–æ–ª–∏ | Alert + –∫–æ–Ω—Å–æ–ª—å |
| –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ | –û–±—â–∏–µ | –£–∫–∞–∑–∞–Ω–∏–µ –Ω–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é —Å —Ç–∞–±–ª–∏—Ü–µ–π |
| –§–æ—Ä–º–∞—Ç –¥–∞—Ç—ã | dd.mm.yy | dd.mm.yy (–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ) |
| –°—Ç–æ–ª–±—Ü—ã | 6 | 6 (–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ) |

---

## üéØ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ CSV —Ñ–∞–π–ª–∞

**–§–æ—Ä–º–∞—Ç**: UTF-8 —Å BOM –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–∏—Ä–∏–ª–ª–∏—Ü—ã –≤ Excel

**–°—Ç–æ–ª–±—Ü—ã** (–≤ —Ç–æ—á–Ω–æ—Å—Ç–∏ –∫–∞–∫ –≤ —Ç–∞–±–ª–∏—Ü–µ –ö–æ–Ω—Ç–∞–∫—Ç—ã):
1. **–ö–∞—Ç–µ–≥–æ—Ä–∏—è** - –ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏–ª–∏ "–ë–µ–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏"
2. **–ù–∞–∑–≤–∞–Ω–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏** - –ü–æ–ª–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ
3. **Email** - –ê–¥—Ä–µ—Å —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–π –ø–æ—á—Ç—ã
4. **–û–ø–∏—Å–∞–Ω–∏–µ** - –û–ø–∏—Å–∞–Ω–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏
5. **–í–µ–±-—Å–∞–π—Ç** - URL –≤–µ–±-—Å–∞–π—Ç–∞
6. **–î–∞—Ç–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è** - –§–æ—Ä–º–∞—Ç: dd.mm.yy (–Ω–∞–ø—Ä–∏–º–µ—Ä, 01.10.25)

**–ü—Ä–∏–º–µ—Ä CSV —Ñ–∞–π–ª–∞:**
```csv
–ö–∞—Ç–µ–≥–æ—Ä–∏—è,–ù–∞–∑–≤–∞–Ω–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏,Email,–û–ø–∏—Å–∞–Ω–∏–µ,–í–µ–±-—Å–∞–π—Ç,–î–∞—Ç–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è
–ì–∏–º–Ω–∞—Å—Ç–∏–∫–∞,Gymnastics Club Dubai,info@gymclub.ae,"–°–ø–æ—Ä—Ç–∏–≤–Ω—ã–π –∫–ª—É–± –¥–ª—è –¥–µ—Ç–µ–π",https://gymclub.ae,01.10.25
–°–ø–æ—Ä—Ç,Dubai Sports Center,contact@sports.ae,"–ú–Ω–æ–≥–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π —Å–ø–æ—Ä—Ç–∏–≤–Ω—ã–π —Ü–µ–Ω—Ç—Ä",https://sports.ae,01.10.25
```

---

## üìä –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —ç–∫—Å–ø–æ—Ä—Ç–∞

### –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è
- ‚úÖ –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –∫–æ–Ω—Ç–∞–∫—Ç—ã, –≤–∏–¥–∏–º—ã–µ –≤ —Ç–∞–±–ª–∏—Ü–µ
- ‚úÖ –ï—Å–ª–∏ –≤—ã–±—Ä–∞–Ω —Ñ–∏–ª—å—Ç—Ä –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ - —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –∫–æ–Ω—Ç–∞–∫—Ç—ã —ç—Ç–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
- ‚úÖ –ï—Å–ª–∏ —Ñ–∏–ª—å—Ç—Ä "–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏" - —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –≤—Å–µ –∫–æ–Ω—Ç–∞–∫—Ç—ã

### –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞
- ‚úÖ –ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è —Ç–∞ –∂–µ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞, —á—Ç–æ –∏ –≤ —Ç–∞–±–ª–∏—Ü–µ (`this.dateSortDirection`)
- ‚úÖ –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: –æ—Ç –Ω–æ–≤—ã—Ö –∫ —Å—Ç–∞—Ä—ã–º (desc)
- ‚úÖ –ú–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –∫–ª–∏–∫–æ–º –Ω–∞ –∑–∞–≥–æ–ª–æ–≤–æ–∫ "–î–∞—Ç–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è" –≤ —Ç–∞–±–ª–∏—Ü–µ

### Excel —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å
- ‚úÖ UTF-8 BOM –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ä—É—Å—Å–∫–∏—Ö —Å–∏–º–≤–æ–ª–æ–≤
- ‚úÖ –≠–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—è—Ç—ã—Ö, –∫–∞–≤—ã—á–µ–∫ –∏ –ø–µ—Ä–µ–Ω–æ—Å–æ–≤ —Å—Ç—Ä–æ–∫
- ‚úÖ –§–æ—Ä–º–∞—Ç –¥–∞—Ç—ã –ª–æ–∫–∞–ª–∏–∑–æ–≤–∞–Ω –¥–ª—è –†–æ—Å—Å–∏–∏ (dd.mm.yy)

### –ò–º—è —Ñ–∞–π–ª–∞
- ‚úÖ –§–æ—Ä–º–∞—Ç: `contacts_YYYY-MM-DD_HH-MM-SS.csv`
- ‚úÖ –ü—Ä–∏–º–µ—Ä: `contacts_2025-10-01_14-30-45.csv`
- ‚úÖ Timestamp –¥–ª—è —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏ –∫–∞–∂–¥–æ–≥–æ —ç–∫—Å–ø–æ—Ä—Ç–∞

---

## üîç –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

### –î–æ–±–∞–≤–ª–µ–Ω—ã –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –≤ –∫–æ–¥–µ:
```javascript
// CSV header - EXACT match with displayContacts() table columns
// Build CSV rows - EXACT match with displayContacts() row structure
// üìÖ Sort contacts by date before export (match table display)
```

**–¶–µ–ª—å**: –û–±–µ—Å–ø–µ—á–∏—Ç—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –º–µ–∂–¥—É —Ç–∞–±–ª–∏—Ü–µ–π –∏ CSV –ø—Ä–∏ –±—É–¥—É—â–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö

### –î–æ–±–∞–≤–ª–µ–Ω–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ:
```javascript
alert(`‚úÖ –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ ${sortedContacts.length} –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ –≤ —Ñ–∞–π–ª ${filename}`);
```

**–¶–µ–ª—å**: –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —ç–∫—Å–ø–æ—Ä—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –≠–∫—Å–ø–æ—Ä—Ç –≤—Å–µ—Ö –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤
**–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ**: 14 –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ –≤ –±–∞–∑–µ, —Ñ–∏–ª—å—Ç—Ä "–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏"
**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**:
- ‚úÖ CSV —Ñ–∞–π–ª —Å 14 —Å—Ç—Ä–æ–∫–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö + 1 –∑–∞–≥–æ–ª–æ–≤–æ–∫
- ‚úÖ –í—Å–µ —Å—Ç–æ–ª–±—Ü—ã –∑–∞–ø–æ–ª–Ω–µ–Ω—ã
- ‚úÖ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ "–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ 14 –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤"

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –≠–∫—Å–ø–æ—Ä—Ç —Å —Ñ–∏–ª—å—Ç—Ä–æ–º
**–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ**: 14 –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤, –≤—ã–±—Ä–∞–Ω–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏—è "–ì–∏–º–Ω–∞—Å—Ç–∏–∫–∞" (7 –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤)
**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**:
- ‚úÖ CSV —Ñ–∞–π–ª —Å 7 —Å—Ç—Ä–æ–∫–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö + 1 –∑–∞–≥–æ–ª–æ–≤–æ–∫
- ‚úÖ –í—Å–µ –∫–æ–Ω—Ç–∞–∫—Ç—ã –∏–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ "–ì–∏–º–Ω–∞—Å—Ç–∏–∫–∞"
- ‚úÖ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ "–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ 7 –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤"

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –≠–∫—Å–ø–æ—Ä—Ç –±–µ–∑ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤
**–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ**: –ù–µ—Ç –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ –≤ –±–∞–∑–µ
**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**:
- ‚úÖ Alert: "–ù–µ—Ç –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –ø–∞—Ä—Å–∏–Ω–≥ —Å–Ω–∞—á–∞–ª–∞."
- ‚úÖ CSV —Ñ–∞–π–ª –Ω–µ —Å–æ–∑–¥–∞–µ—Ç—Å—è

### –°—Ü–µ–Ω–∞—Ä–∏–π 4: Excel –æ—Ç–∫—Ä—ã—Ç–∏–µ
**–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ**: –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π CSV —Ñ–∞–π–ª
**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**:
- ‚úÖ Excel –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç —Ñ–∞–π–ª –±–µ–∑ –æ—à–∏–±–æ–∫
- ‚úÖ –ö–∏—Ä–∏–ª–ª–∏—Ü–∞ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –í—Å–µ —Å—Ç–æ–ª–±—Ü—ã —Ä–∞–∑–¥–µ–ª–µ–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ

---

## üìö –°–≤—è–∑–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

- **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π —Ñ–∞–π–ª**: `script.js:3209-3314`
- **–§—É–Ω–∫—Ü–∏—è**: `exportContactsToCSV()`
- **–í—ã–∑–æ–≤**: `bindExportContacts()` (script.js:3317-3328)
- **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è**: `initializeUI()` —Å—Ç—Ä–æ–∫–∞ 525

---

## üîó –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å–∏—Å—Ç–µ–º–æ–π

### Event binding:
```javascript
// script.js:3317-3328
bindExportContacts() {
    console.log('üì• Binding export contacts button...');

    const exportBtn = document.getElementById('exportContactsBtn');

    if (exportBtn) {
        exportBtn.addEventListener('click', () => {
            console.log('üì• Export contacts button clicked');
            this.exportContactsToCSV();
        });
        console.log('‚úÖ Export contacts button bound successfully');
    } else {
        console.log('‚ùå Export contacts button not found');
    }
}
```

### HTML button:
```html
<!-- index.html:446-451 -->
<button id="exportContactsBtn" class="export-btn">
    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
        <path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"/>
    </svg>
    –≠–∫—Å–ø–æ—Ä—Ç –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤
</button>
```

---

**–°—Ç–∞—Ç—É—Å**: ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û**
**–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ**: Event listener –ø—Ä–∏–≤—è–∑–∞–Ω, –ª–æ–≥–∏–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ —Å —Ç–∞–±–ª–∏—Ü–µ–π
**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —ç–∫—Å–ø–æ—Ä—Ç —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –≤ —Ä–∞–∑–Ω—ã—Ö –±—Ä–∞—É–∑–µ—Ä–∞—Ö

---

**–°–æ–∑–¥–∞–Ω–æ**: Claude Code
**–î–∞—Ç–∞**: October 1, 2025
